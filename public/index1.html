<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Google Drive Real-Time Updates</title>
  <script src="https://cdn.socket.io/4.1.3/socket.io.min.js"></script>
</head>
<body>
  <h1>Google Drive Real-Time Updates</h1>
  <input type="text" id="fileId" placeholder="Enter file ID to watch" />
  <button id="watchButton">Watch File</button>
  <ul id="permissions"></ul>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const socket = io('http://localhost:3000');

      function watchFile() {
        const fileId = document.getElementById('fileId').value;
        console.log('Emitting watchFile event with fileId:', fileId);
        socket.emit('watchFile', fileId);

        socket.on('permissionsUpdated', (permissions) => {
          console.log('Received permissionsUpdated event with data:', permissions);
          const permissionsList = document.getElementById('permissions');
          permissionsList.innerHTML = '';
          permissions.forEach(permission => {
            const li = document.createElement('li');
            li.textContent = JSON.stringify(permission);
            permissionsList.appendChild(li);
          });
        });
      }

      // Attach event listener to the button
      document.getElementById('watchButton').addEventListener('click', watchFile);

      socket.on('connect', () => {
        console.log('Connected to server');
      });

      socket.on('disconnect', () => {
        console.log('Disconnected from server');
      });
    });
  </script>
</body>
</html>
